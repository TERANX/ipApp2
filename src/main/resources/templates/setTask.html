<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
        $(document).ready(function () {
            let optionsCounter = 1;

            // Обработчик события добавления нового варианта ответа
            $("#add-option-btn").click(function () {
                let optionInput = '<div><input type="text" name="option' + optionsCounter + '" id="option' + optionsCounter + '">';
                optionInput += '<input type="checkbox" name="correct' + optionsCounter + '"> Правильный вариант</div>';

                $("#options-container").append(optionInput);

                optionsCounter++;
            });

            // Обработчик события сохранения задачи
            $("#setTask-btn").click(function () {
                let taskTitle = $("#task-title").val();
                let taskDesc = $("#task-description").val();
                let taskDif = $("#task-difficulty").val();

                // $('#task-container').append(taskTitle, taskDesc, taskDif);

                const elems = document.getElementsByClassName("opt");
                let options = jQuery.makeArray(elems);
                for (let i = 1; i < optionsCounter; i++) {
                    let optionText = $("#option" + i).val();
                    let isCorrect = $("#option" + i + ":checkbox:checked").length > 0;

                    isCorrect = !!document.getElementById('correct1').checked;

                    options.push({optionText: optionText, isCorrect: isCorrect});
                }

                let data = {taskTitle: taskTitle, taskDesk: taskDesc, taskDif: taskDif, options: options};

                $.post("/setTask", data, function () {
                    console.log("Задача сохранена успешно!");

                    // Очистить поля ввода
                    $("#task-title").val("");
                    $("#task-description").val("");
                    $("#task-difficulty").val("");

                    // Очистить контейнер с вариантами ответов
                    $("#options-container").empty();

                    // Сбросить счетчик вариантов ответов
                    optionsCounter = 1;
                })
                    .fail(function (error) {
                        console.error("Ошибка при сохранении задачи", error);
                    });
            });
        });
    </script>
</head>
<body>
<div id="task-container">
    <div class="form-group">
    <label for="task-title">Task Title</label>
    <input aria-describedby="textHelp" class="form-control" id="task-title"
           type="text">
</div>


<div class="form-group">
    <label for="task-description">Description</label>
    <textarea aria-describedby="textHelp" class="form-control" id="task-description"></textarea>

</div>
<br>
<div class="form-group">
    <label for="task-difficulty">Difficulty:</label>
    <select name="difficulty" id="task-difficulty" required>
        <option value="easy">Easy</option>
        <option value="medium">Medium</option>
        <option value="hard">Hard</option>
    </select>

</div>

<br>

<div id="options-container">
    <label>Варианты ответов:</label>
    <div>
        <input type="text" name="option1" id="option1" class="opt">
        <input type="checkbox" name="correct1" class="opt"> Правильный вариант
    </div>
</div>
<br>
<button id="add-option-btn">Добавить вариант ответа</button>
<br>
<button id="setTask-btn">Сохранить задачу</button>
</div>


</body>
</html>